<div class="modal-header anexo bg-danger text-white">
    <h4 class="modal-title"> {{ this.codigoProcedimientoTupa}} {{ this.descProcedimientoTupa}}</h4>
    <button type="button" class="btn-close btn-close-white" aria-label="Close" (click)="activeModal.close(graboUsuario)">
        
    </button>
</div>
<div class="modal-body anexo">
    <div class="container-fluid">
        <form novalidate [formGroup]="formulario">
            <div class="mt-1 mb-3">
                <h6 class="mb-0">{{txtTitulo}}</h6>
                <h6 class="text-muted">{{txtTituloHelp}}</h6>
            </div>
            <div ngbAccordion #acc="ngbAccordion" activeIds="seccion-1, seccion-2">

                <div ngbAccordionItem="seccion-1" [collapsed]="false">
                    <h2 ngbAccordionHeader >
                        
                            <button ngbAccordionButton>DATOS DEL DECLARANTE</button>
                        </h2>
                    <div ngbAccordionCollapse>
<div ngbAccordionBody>
<ng-template>

                        <div class="lista-representantes mx-2">
                            <div class="justify-content-between">
                                <h5>Lista de Representantes Legales y/o socio/accionistas de la solicitante</h5>
                                <button class="btn btn-success" (click)="abrirModalDeclarante(modalagregar)"><i class="fas fa-plus"></i> Agregar</button>
                            </div>
                            <hr class="mt-2">

                            <div ngbAccordion #a="ngbAccordion">
                                <div  ngbAccordionItem *ngFor="let item of listaHojaDatos; let i = index">
                                  <h2 ngbAccordionHeader >
                                    
                                      <span class="text-bold m-0 me-4 text-nowrap"><h4 class="m-0">{{ i+1 }}</h4></span>
                                      <span class="text-bold m-0 w-100">{{item.seccion1.nombres}} {{item.seccion1.apellidoPaterno}} {{item.seccion1.apellidoMaterno}}
                                          <span *ngIf="i===0" class="badge text-bg-secondary">SOLICITANTE</span>
                                      </span>
                                      <div class="text-nowrap">
                                        <button ngbAccordionButton>
                                            <i class="fas" [ngClass]="(opened)?'fa-eye-slash':'fa-eye'"></i>
                                        </button>
                                        <button *ngIf="i>0" class="btn btn-sm btn-primary ms-1" (click)="abrirModalDeclarante(modalagregar,i)"><i class="fas fa-pencil-alt"></i></button>
                                        <button *ngIf="i>0" class="btn btn-sm btn-danger ms-1" (click)="eliminarDeclarante(i)"><i class="fas fa-trash"></i></button>
                                      </div>
                                      </h2>
                                  <ng-template ngbPanelContent>
                                    <div class="mx-2">
                                        <div class="row">

                                            <div class="col-md">
                                                <div class="mb-3 row my-0">
                                                    <label class="col-md-3 text-bold py-0 my-0">Documento de Identidad</label>
                                                    <div class="col-md-9">
                                                        <span class="border-0 py-0 my-0">{{item.seccion1.tipoDocumento.documento}} - {{item.seccion1.numeroDocumento}}</span>
                                                    </div>
                                                </div>

                                                <div class="mb-3 row my-0">
                                                    <label class="col-md-3 text-bold py-0 my-0">Domicilio Legal</label>
                                                    <div class="col-md-9">
                                                        <span class="border-0 py-0 my-0">
                                                            {{item.seccion1.domicilioLegal}} - {{item.seccion1.distrito}}, {{item.seccion1.provincia}}, {{item.seccion1.departamento}}
                                                        </span>
                                                    </div>
                                                </div>

                                                <div class="mb-3 row my-0">
                                                    <label class="col-md-3 text-bold py-0 my-0">Teléfono Fijo</label>
                                                    <div class="col-md-9">
                                                        <span class="border-0 py-0 my-0">{{item.seccion1.telefono}}</span>
                                                    </div>
                                                </div>

                                                <div class="mb-3 row my-0">
                                                    <label class="col-md-3 text-bold py-0 my-0">Celular</label>
                                                    <div class="col-md-9">
                                                        <span class="border-0 py-0 my-0">{{item.seccion1.celular}}</span>
                                                    </div>
                                                </div>

                                                <div class="mb-3 row my-0">
                                                    <label class="col-md-3 text-bold py-0 my-0">Correo electrónico</label>
                                                    <div class="col-md-9">
                                                        <span class="border-0 py-0 my-0">{{item.seccion1.email}}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-auto" *ngIf="i>0">
                                                <div class="mb-3 my-0">
                                                    <div class="col-md text-bold text-md-right">Declaración Jurada:</div>
                                                    <div *ngIf="item.seccion2.declaracion1" class="col-md text-bold text-end text-success"><i class="fas fa-check-square"></i> SI</div>
                                                    <div *ngIf="!item.seccion2.declaracion1" class="col-md text-bold text-end text-danger">PENDIENTE</div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                  </ng-template>
                                </div>
                            </div>

                        </div>

                    </ng-template>
                </div>
                </div>
                </div>

                <div ngbAccordionItem="seccion-2" [collapsed]="false">
                    <h2 ngbAccordionHeader >
                        
                            <button ngbAccordionButton>DECLARACIÓN JURADA</button>
                        </h2>
                    <div ngbAccordionCollapse>
<div ngbAccordionBody>
<ng-template>

                        <div class="px-2 py-3">
                            <p>
                                En mi calidad de representante legal de la solicitante y/o socia/accionista de la solicitante del otorgamiento de concesión única para prestar el (los) Servicio (s) Público (s) de Telecomunicaciones indicado (s) en el Formulario de la solicitud, y en aplicación del principio de presunción de veracidad estipulada en el numeral 1.7 del Art. IV del Texto Único Ordenado de la Ley Nº 27444 del Procedimiento Administrativo General, aprobado por Decreto Supremo N° 004-2019 JUS.
                            </p>

                            <p class="text-bold">
                                DECLARO:
                            </p>
                            <div class="alert alert-custom">
                                <ul>
                                    <li>
                                        <div class="row" [class.control-invalid]="formInvalid(Declaracion1Solicitante)">
                                            <div class="col-md">
                                                <p>
                                                    No estar impedido de contratar con el Estado, en razón de lo dispuesto en los artículos 1366º y 1367º del Código Civil, la Ley General del Sistema Concursal, por resolución judicial o del Tribunal de Contrataciones y Adquisiciones del Estado, u otros, ni incurso en las limitaciones establecidas en el Texto Único Ordenado de la Ley de Telecomunicaciones ni en los artículos 113º, 125º y otros que correspondan del Texto Único Ordenado del Reglamento General de la Ley de Telecomunicaciones aprobado con Decreto Supremo Nº 020-2007-MTC.
                                                </p>
                                            </div>
                                            <div class="col-auto">
                                                <div class="d-flex flex-row p-2 ms-4">
                                                    <ui-switch formControlName="Declaracion1Solicitante" class="ng-valid ng-touched ng-dirty"></ui-switch> NO / SI
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>

                            <p>
                                Lima, {{this.dia}} de {{this.mes}} del {{this.anio}}
                            </p>
                        </div>

                    </ng-template>
</div>
</div>
                </div>

            </div>
        </form>
    </div>
</div>
<div class="modal-footer anexo">
    <div class="row">
        <div class="col-sm-12 d-flex">
            <div class="flex-1">
                <button type="button" class="btn btn-secondary" [disabled]="id === 0" (click)="descargarPdf()">
                    <i class="far fa-eye"></i> Visualizar
                </button>
            </div>
            <div class="flex-1 text-end">
                <button class="btn btn-success boton-guardar" (click)="guardarAnexo()">
                    <i class="fas fa-save"></i> Guardar
                </button>
                <button type="button" class="btn btn-light ms-2" (click)="activeModal.close(graboUsuario)">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>


<ng-template #modalagregar let-modal>
    <div class="modal-header bg-secondary text-white">
      <h5 class="modal-title">Agregar</h5>
      <button type="button" class="close text-white" aria-label="Close" (click)="modal.dismiss()">
        
      </button>
    </div>
    <div class="modal-body p-4">
        <form  [formGroup]="formularioDeclarante">
            <span class="d-block px-3 py-2 bg-secondary text-white mb-3">Datos Personales</span>

            <div class="d-block p-2 mb-3">
                <div class="row gx-2">
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Tipo Documento</label>
                            <select #tipoDoc class="form-select form-select-sm" (change)="changeTipoDocumento(tipoDoc.value); resetDatosRepresentante();"
                                formControlName="IdTipoDocumento" [class.control-invalid]="formInvalid(IdTipoDocumento)">
                                <option value="">- Seleccionar -</option>
                                <option *ngFor="let item of listaTiposDocumentos;" [value]="item.id">{{ item.documento }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Nro. Documento</label>
                            <div class="input-group input-group-sm">
                                <input #nroDoc type="text" class="form-control form-control-sm text-uppercase" [maxLength]="maxLengthNroDocumento"
                                    (keypress)="soloNumeros($event); onPressEnterNroDoc($event, tipoDoc.value, nroDoc.value)"
                                    (input)="onInputNroDoc()"
                                    formControlName="NumeroDocumento" [class.control-invalid]="formInvalid(NumeroDocumento)">
                                    <button class="btn btn-outline-secondary" type="button"
                                        [disabled]="NumeroDocumento.invalid || IdTipoDocumento.invalid || !habilitarBusquedaRepresentante"
                                        (click)="buscarRepresentanteLegal(tipoDoc.value, nroDoc.value)">
                                        <i class="fas fa-search"></i>
                                    </button>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="row gx-2">
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Nombres</label>
                            <input type="text" class="form-control form-control-sm text-uppercase"
                                formControlName="Nombres" [class.control-invalid]="formInvalid(Nombres)">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Apellido paterno</label>
                            <input type="text" class="form-control form-control-sm text-uppercase"
                                formControlName="ApellidoPaterno" [class.control-invalid]="formInvalid(ApellidoPaterno)">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Apellido materno</label>
                            <input type="text" class="form-control form-control-sm text-uppercase"
                                formControlName="ApellidoMaterno" [class.control-invalid]="formInvalid(ApellidoMaterno)">
                        </div>
                    </div>
                </div>

                <div class="row gx-2">
                    <div class="col-md-12">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Domiciilio legal</label>
                            <input type="text" class="form-control form-control-sm text-uppercase"
                                formControlName="DomicilioLegal" [class.control-invalid]="formInvalid(DomicilioLegal)">
                        </div>
                    </div>
                </div>

                <div class="row gx-2">
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Departamento</label>
                            <select class="form-select form-select-sm" formControlName="Departamento" #departamentoRep
                                (change)="onChangeDepartamento(departamentoRep.value)"
                                [class.control-invalid]="formInvalid(Departamento)">
                                <option value="">- Seleccionar -</option>
                                <option *ngFor="let item of listaDepartamentos;" [value]="item.value">{{ item.text }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Provincia</label>
                            <select class="form-select form-select-sm" formControlName="Provincia" #provinciaRep
                                (change)="onChangeProvincia(departamentoRep.value, provinciaRep.value)"
                                [class.control-invalid]="formInvalid(Provincia)">
                                <option value=""> Seleccionar -</option>
                                <option *ngFor="let item of listaProvincias;" [value]="item.value">{{ item.text }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Distrito</label>
                            <select class="form-select form-select-sm" formControlName="Distrito" #distritoRep
                                [class.control-invalid]="formInvalid(Distrito)">
                                <option value="">- Seleccionar -</option>
                                <option *ngFor="let item of listaDistritos;" [value]="item.value">{{ item.text }}</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row gx-2">
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Teléfono fijo</label>
                            <input type="text" class="form-control form-control-sm text-uppercase" maxlength="9"
                            (keypress)="soloNumeros($event);"
                            formControlName="Telefono" [class.control-invalid]="formInvalid(Telefono)">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Celular</label>
                            <input type="text" class="form-control form-control-sm text-uppercase" maxlength="12"
                            (keypress)="soloNumeros($event);"
                            formControlName="Celular" [class.control-invalid]="formInvalid(Celular)">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="mb-2">
                            <label class="text-bold mb-1">Correo electrónico</label>
                            <input type="text" class="form-control form-control-sm text-uppercase"
                            formControlName="Email" [class.control-invalid]="formInvalid(Email)">
                        </div>
                    </div>
                </div>
            </div>

            <span class="d-block px-3 py-2 bg-secondary text-white mb-3">Declaración Jurada</span>

            <div class="d-block p-2 mb-3 small">
                <p>
                    En mi calidad de representante legal de la solicitante y/o socia/accionista de la solicitante del otorgamiento de concesión única para prestar el (los) Servicio (s) Público (s) de Telecomunicaciones indicado (s) en el Formulario de la solicitud, y en aplicación del principio de presunción de veracidad estipulada en el numeral 1.7 del Art. IV del Texto Único Ordenado de la Ley Nº 27444 del Procedimiento Administrativo General, aprobado por Decreto Supremo N° 004-2019 JUS.
                </p>

                <p class="text-bold">
                    DECLARO:
                </p>

                <div class="alert alert-custom">
                    <ul>
                        <li>
                            <div class="row" [class.control-invalid]="formInvalid(Declaracion1)">
                                <div class="col-md">
                                    <p>
                                        No estar impedido de contratar con el Estado, en razón de lo dispuesto en los artículos 1366º y 1367º del Código Civil, la Ley General del Sistema Concursal, por resolución judicial o del Tribunal de Contrataciones y Adquisiciones del Estado, u otros, ni incurso en las limitaciones establecidas en el Texto Único Ordenado de la Ley de Telecomunicaciones ni en los artículos 113º, 125º y otros que correspondan del Texto Único Ordenado del Reglamento General de la Ley de Telecomunicaciones aprobado con Decreto Supremo Nº 020-2007-MTC.
                                    </p>
                                </div>
                                <div class="col-auto">
                                    <div class="d-flex flex-row p-2 ms-4">
                                        <ui-switch formControlName="Declaracion1" class="ng-valid ng-touched ng-dirty"></ui-switch> NO / SI
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <p>
                    Lima, {{this.dia}} de {{this.mes}} del {{this.anio}}
                </p>
            </div>

        </form>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-success" (click)="guardarDeclarante()" [disabled]="this.formularioDeclarante.invalid">
            Guardar
        </button>
        <button type="button" class="btn btn-light" (click)="modal.close()">Cancelar</button>
    </div>
</ng-template>
